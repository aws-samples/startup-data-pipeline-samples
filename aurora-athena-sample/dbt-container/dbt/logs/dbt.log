[0m14:59:10.837437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623eee0>]}


============================== 14:59:10.845762 | 8449c72f-523a-4abf-8767-01f60ced0685 ==============================
[0m14:59:10.845762 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:59:10.846876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:59:11.564956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8449c72f-523a-4abf-8767-01f60ced0685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621b910>]}
[0m14:59:11.622903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8449c72f-523a-4abf-8767-01f60ced0685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607e1c0>]}
[0m14:59:11.624064 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m14:59:11.765262 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:59:11.901958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:59:11.902750 [debug] [MainThread]: Partial parsing: added file: sampletikcetdata://models/date.yml
[0m14:59:11.903253 [debug] [MainThread]: Partial parsing: updated file: sampletikcetdata://models/new_sales.sql
[0m14:59:12.301064 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m14:59:12.336484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8449c72f-523a-4abf-8767-01f60ced0685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089eff70>]}
[0m14:59:12.623237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8449c72f-523a-4abf-8767-01f60ced0685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f5550>]}
[0m14:59:12.624174 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m14:59:12.624830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8449c72f-523a-4abf-8767-01f60ced0685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f5f70>]}
[0m14:59:12.627280 [info ] [MainThread]: 
[0m14:59:12.628223 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m14:59:12.629550 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m14:59:12.630257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:13.368982 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:59:13.370056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m14:59:13.370430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:14.622989 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m14:59:14.623688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8449c72f-523a-4abf-8767-01f60ced0685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b9eb0>]}
[0m14:59:14.624197 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m14:59:14.624499 [info ] [MainThread]: 
[0m14:59:14.626503 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m14:59:14.627023 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m14:59:14.627547 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m14:59:14.627921 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m14:59:14.638039 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m14:59:14.639568 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m14:59:14.712910 [debug] [Thread-1  ]: Skip partitioning: False
[0m14:59:14.713745 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
'date' is not a valid S3DataNaming
[0m14:59:14.720392 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 77, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 322, in generate_s3_location
    return mapping[self._s3_data_naming(s3_data_naming)]
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 290, in _s3_data_naming
    return S3DataNaming(s3_data_naming)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/enum.py", line 384, in __call__
    return cls.__new__(cls, value)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/enum.py", line 702, in __new__
    raise ve_exc
ValueError: 'date' is not a valid S3DataNaming

[0m14:59:14.722264 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8449c72f-523a-4abf-8767-01f60ced0685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a89850>]}
[0m14:59:14.722879 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbt.new_sales ............................ [[31mERROR[0m in 0.09s]
[0m14:59:14.723704 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m14:59:14.724717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:14.725035 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m14:59:14.725320 [info ] [MainThread]: 
[0m14:59:14.725646 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m14:59:14.726260 [debug] [MainThread]: Command end result
[0m14:59:14.768197 [info ] [MainThread]: 
[0m14:59:14.768686 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:59:14.768978 [info ] [MainThread]: 
[0m14:59:14.769319 [error] [MainThread]:   'date' is not a valid S3DataNaming
[0m14:59:14.769586 [info ] [MainThread]: 
[0m14:59:14.769868 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:59:14.771860 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.028098, "process_user_time": 3.00615, "process_kernel_time": 0.617967, "process_mem_max_rss": "173015040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:59:14.772397 [debug] [MainThread]: Command `dbt run` failed at 14:59:14.772308 after 4.03 seconds
[0m14:59:14.772762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af1fd0>]}
[0m14:59:14.773182 [debug] [MainThread]: Flushing usage events
[0m15:01:25.976834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121716af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123caa4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123caaee0>]}


============================== 15:01:25.981158 | e213cadc-ffec-4bec-8517-e83989ac9aa0 ==============================
[0m15:01:25.981158 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:01:25.981734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:01:26.596304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e213cadc-ffec-4bec-8517-e83989ac9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c78820>]}
[0m15:01:26.643784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e213cadc-ffec-4bec-8517-e83989ac9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c831f0>]}
[0m15:01:26.645045 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:01:26.761792 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:01:26.902125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:01:26.902735 [debug] [MainThread]: Partial parsing: updated file: sampletikcetdata://models/new_sales.sql
[0m15:01:27.105811 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:01:27.119774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e213cadc-ffec-4bec-8517-e83989ac9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126b23130>]}
[0m15:01:27.217941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e213cadc-ffec-4bec-8517-e83989ac9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228cbe50>]}
[0m15:01:27.218466 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:01:27.218781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e213cadc-ffec-4bec-8517-e83989ac9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126adca90>]}
[0m15:01:27.220014 [info ] [MainThread]: 
[0m15:01:27.220511 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:01:27.221222 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:01:27.221594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:27.928721 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:01:27.930638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:01:27.931217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:29.254864 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:01:29.256196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e213cadc-ffec-4bec-8517-e83989ac9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1273fc070>]}
[0m15:01:29.257306 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:01:29.257973 [info ] [MainThread]: 
[0m15:01:29.260961 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:01:29.261799 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:01:29.262431 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:01:29.262817 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:01:29.273386 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:01:29.274457 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:01:29.336735 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:01:29.337509 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
'date' is not a valid S3DataNaming
[0m15:01:29.343316 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 77, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 322, in generate_s3_location
    return mapping[self._s3_data_naming(s3_data_naming)]
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 290, in _s3_data_naming
    return S3DataNaming(s3_data_naming)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/enum.py", line 384, in __call__
    return cls.__new__(cls, value)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/enum.py", line 702, in __new__
    raise ve_exc
ValueError: 'date' is not a valid S3DataNaming

[0m15:01:29.345386 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e213cadc-ffec-4bec-8517-e83989ac9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122981130>]}
[0m15:01:29.346261 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbt.new_sales ............................ [[31mERROR[0m in 0.08s]
[0m15:01:29.346884 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:01:29.347878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:29.348169 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:01:29.348730 [info ] [MainThread]: 
[0m15:01:29.349389 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m15:01:29.350020 [debug] [MainThread]: Command end result
[0m15:01:29.381349 [info ] [MainThread]: 
[0m15:01:29.381808 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:01:29.382101 [info ] [MainThread]: 
[0m15:01:29.382441 [error] [MainThread]:   'date' is not a valid S3DataNaming
[0m15:01:29.382705 [info ] [MainThread]: 
[0m15:01:29.382983 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:01:29.384896 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4808893, "process_user_time": 2.469758, "process_kernel_time": 0.510333, "process_mem_max_rss": "172785664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:01:29.385406 [debug] [MainThread]: Command `dbt run` failed at 15:01:29.385320 after 3.48 seconds
[0m15:01:29.385745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121716af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123005790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a45a90>]}
[0m15:01:29.386071 [debug] [MainThread]: Flushing usage events
[0m15:02:06.701972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d0ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a7e50>]}


============================== 15:02:06.706178 | 027f1aca-d20e-4ee8-a6c0-6d5fcdb3ee93 ==============================
[0m15:02:06.706178 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:02:06.706730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:02:07.395452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '027f1aca-d20e-4ee8-a6c0-6d5fcdb3ee93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e4c40>]}
[0m15:02:07.449970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '027f1aca-d20e-4ee8-a6c0-6d5fcdb3ee93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110939310>]}
[0m15:02:07.451517 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:02:07.574880 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:02:07.700927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:02:07.701598 [debug] [MainThread]: Partial parsing: updated file: sampletikcetdata://models/new_sales.sql
[0m15:02:07.907167 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:02:07.921782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '027f1aca-d20e-4ee8-a6c0-6d5fcdb3ee93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110df4130>]}
[0m15:02:08.026941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '027f1aca-d20e-4ee8-a6c0-6d5fcdb3ee93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c20940>]}
[0m15:02:08.027449 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:02:08.027761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '027f1aca-d20e-4ee8-a6c0-6d5fcdb3ee93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032929d0>]}
[0m15:02:08.029011 [info ] [MainThread]: 
[0m15:02:08.030904 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:02:08.031701 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:02:08.032062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:08.701977 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:02:08.704701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:02:08.705233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:10.166465 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:02:10.193428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '027f1aca-d20e-4ee8-a6c0-6d5fcdb3ee93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eccca0>]}
[0m15:02:10.198227 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:02:10.202530 [info ] [MainThread]: 
[0m15:02:10.238146 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:02:10.249483 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:02:10.253014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:02:10.261970 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:02:10.379448 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:02:10.382227 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:02:10.831729 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:02:10.834474 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
'date' is not a valid S3DataNaming
[0m15:02:10.873980 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 77, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 322, in generate_s3_location
    return mapping[self._s3_data_naming(s3_data_naming)]
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 290, in _s3_data_naming
    return S3DataNaming(s3_data_naming)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/enum.py", line 384, in __call__
    return cls.__new__(cls, value)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/enum.py", line 702, in __new__
    raise ve_exc
ValueError: 'date' is not a valid S3DataNaming

[0m15:02:10.888115 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '027f1aca-d20e-4ee8-a6c0-6d5fcdb3ee93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a98ee0>]}
[0m15:02:10.890181 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbt.new_sales ............................ [[31mERROR[0m in 0.63s]
[0m15:02:10.893261 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:02:10.907927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:10.910854 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:02:10.918022 [info ] [MainThread]: 
[0m15:02:10.920034 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m15:02:10.926873 [debug] [MainThread]: Command end result
[0m15:02:11.060294 [info ] [MainThread]: 
[0m15:02:11.061792 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:02:11.062728 [info ] [MainThread]: 
[0m15:02:11.063472 [error] [MainThread]:   'date' is not a valid S3DataNaming
[0m15:02:11.064061 [info ] [MainThread]: 
[0m15:02:11.066312 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:02:11.081692 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.449788, "process_user_time": 2.661077, "process_kernel_time": 0.529874, "process_mem_max_rss": "161546240", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:02:11.087121 [debug] [MainThread]: Command `dbt run` failed at 15:02:11.085694 after 4.46 seconds
[0m15:02:11.088480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d0ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aadeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703be20>]}
[0m15:02:11.089624 [debug] [MainThread]: Flushing usage events
[0m15:02:30.936380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102880ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430feb0>]}


============================== 15:02:30.940548 | caf57136-a076-48cc-89f4-afd7a46d9fdb ==============================
[0m15:02:30.940548 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:02:30.941077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:02:31.582119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caf57136-a076-48cc-89f4-afd7a46d9fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf69d0>]}
[0m15:02:31.631614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caf57136-a076-48cc-89f4-afd7a46d9fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d14b80>]}
[0m15:02:31.632807 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:02:31.743790 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:02:31.876164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:02:31.876795 [debug] [MainThread]: Partial parsing: updated file: sampletikcetdata://models/new_sales.sql
[0m15:02:32.078115 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:02:32.093094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caf57136-a076-48cc-89f4-afd7a46d9fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4c130>]}
[0m15:02:32.192827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caf57136-a076-48cc-89f4-afd7a46d9fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a995e0>]}
[0m15:02:32.193342 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:02:32.193659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caf57136-a076-48cc-89f4-afd7a46d9fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c03a90>]}
[0m15:02:32.194898 [info ] [MainThread]: 
[0m15:02:32.195387 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:02:32.196111 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:02:32.196490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:32.872662 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:02:32.874716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:02:32.875182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:34.175829 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:02:34.177782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caf57136-a076-48cc-89f4-afd7a46d9fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a40cd30>]}
[0m15:02:34.179347 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:02:34.180806 [info ] [MainThread]: 
[0m15:02:34.186142 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:02:34.189402 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:02:34.190992 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:02:34.192041 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:02:34.216847 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:02:34.221519 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:02:34.397260 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:02:34.398737 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
'date' is not a valid S3DataNaming
[0m15:02:34.415714 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 77, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 322, in generate_s3_location
    return mapping[self._s3_data_naming(s3_data_naming)]
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 290, in _s3_data_naming
    return S3DataNaming(s3_data_naming)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/enum.py", line 384, in __call__
    return cls.__new__(cls, value)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/enum.py", line 702, in __new__
    raise ve_exc
ValueError: 'date' is not a valid S3DataNaming

[0m15:02:34.422794 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caf57136-a076-48cc-89f4-afd7a46d9fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036eb7f0>]}
[0m15:02:34.426852 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbt.new_sales ............................ [[31mERROR[0m in 0.23s]
[0m15:02:34.428343 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:02:34.431714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:34.435016 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:02:34.435847 [info ] [MainThread]: 
[0m15:02:34.436546 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m15:02:34.439317 [debug] [MainThread]: Command end result
[0m15:02:34.519431 [info ] [MainThread]: 
[0m15:02:34.521211 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:02:34.521845 [info ] [MainThread]: 
[0m15:02:34.522831 [error] [MainThread]:   'date' is not a valid S3DataNaming
[0m15:02:34.523643 [info ] [MainThread]: 
[0m15:02:34.524463 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:02:34.529446 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6617022, "process_user_time": 2.562481, "process_kernel_time": 0.547772, "process_mem_max_rss": "161366016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:02:34.530982 [debug] [MainThread]: Command `dbt run` failed at 15:02:34.530775 after 3.66 seconds
[0m15:02:34.532482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102880ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a78610>]}
[0m15:02:34.533660 [debug] [MainThread]: Flushing usage events
[0m15:04:55.222341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123ab490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123abe80>]}


============================== 15:04:55.226516 | cbb5b58b-08a8-4679-84cd-bae399c5a182 ==============================
[0m15:04:55.226516 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:04:55.227056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:04:55.842682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbb5b58b-08a8-4679-84cd-bae399c5a182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123902b0>]}
[0m15:04:55.890452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbb5b58b-08a8-4679-84cd-bae399c5a182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112386190>]}
[0m15:04:55.891588 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:04:56.020005 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:04:56.224379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:04:56.225509 [debug] [MainThread]: Partial parsing: updated file: sampletikcetdata://models/new_sales.sql
[0m15:04:56.545156 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:04:56.560784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbb5b58b-08a8-4679-84cd-bae399c5a182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115323130>]}
[0m15:04:56.668462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbb5b58b-08a8-4679-84cd-bae399c5a182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115070820>]}
[0m15:04:56.668963 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:04:56.669277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbb5b58b-08a8-4679-84cd-bae399c5a182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11523e8e0>]}
[0m15:04:56.670542 [info ] [MainThread]: 
[0m15:04:56.671032 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:04:56.671758 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:04:56.672135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:57.439166 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:04:57.441669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:04:57.442338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:58.739499 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:04:58.740661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbb5b58b-08a8-4679-84cd-bae399c5a182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115acccd0>]}
[0m15:04:58.741499 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:04:58.742014 [info ] [MainThread]: 
[0m15:04:58.745186 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:04:58.746185 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:04:58.746977 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:04:58.747597 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:04:58.759202 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:04:58.760159 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:04:58.824324 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:04:58.825133 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
'date' is not a valid S3DataNaming
[0m15:04:58.830946 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 77, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 322, in generate_s3_location
    return mapping[self._s3_data_naming(s3_data_naming)]
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 290, in _s3_data_naming
    return S3DataNaming(s3_data_naming)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/enum.py", line 384, in __call__
    return cls.__new__(cls, value)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/enum.py", line 702, in __new__
    raise ve_exc
ValueError: 'date' is not a valid S3DataNaming

[0m15:04:58.832777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbb5b58b-08a8-4679-84cd-bae399c5a182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100b2fa0>]}
[0m15:04:58.833433 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbt.new_sales ............................ [[31mERROR[0m in 0.09s]
[0m15:04:58.833964 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:04:58.834918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:58.835238 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:04:58.835523 [info ] [MainThread]: 
[0m15:04:58.835811 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m15:04:58.836352 [debug] [MainThread]: Command end result
[0m15:04:58.866589 [info ] [MainThread]: 
[0m15:04:58.867065 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:04:58.867352 [info ] [MainThread]: 
[0m15:04:58.867682 [error] [MainThread]:   'date' is not a valid S3DataNaming
[0m15:04:58.867946 [info ] [MainThread]: 
[0m15:04:58.868229 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:04:58.870206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7223809, "process_user_time": 2.586163, "process_kernel_time": 0.529414, "process_mem_max_rss": "174063616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:04:58.870769 [debug] [MainThread]: Command `dbt run` failed at 15:04:58.870678 after 3.72 seconds
[0m15:04:58.871246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101a8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11233f820>]}
[0m15:04:58.871640 [debug] [MainThread]: Flushing usage events
[0m15:07:03.925760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f96b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f2b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f2be80>]}


============================== 15:07:03.930077 | 643bc648-0e30-4f9b-9024-11a76d88fb7b ==============================
[0m15:07:03.930077 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:07:03.930610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:07:04.560622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '643bc648-0e30-4f9b-9024-11a76d88fb7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d0e80>]}
[0m15:07:04.609254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '643bc648-0e30-4f9b-9024-11a76d88fb7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11887bf40>]}
[0m15:07:04.610423 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:07:04.725357 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:07:04.814237 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:07:04.814709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '643bc648-0e30-4f9b-9024-11a76d88fb7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11823d880>]}
[0m15:07:06.129939 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:07:06.141554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '643bc648-0e30-4f9b-9024-11a76d88fb7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc98dc0>]}
[0m15:07:06.244276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '643bc648-0e30-4f9b-9024-11a76d88fb7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd081f0>]}
[0m15:07:06.244912 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:07:06.245220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '643bc648-0e30-4f9b-9024-11a76d88fb7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc9b130>]}
[0m15:07:06.246307 [info ] [MainThread]: 
[0m15:07:06.246774 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:07:06.247487 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:07:06.247851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:06.884822 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:07:06.886020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:07:06.886431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:08.151049 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:07:08.151719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '643bc648-0e30-4f9b-9024-11a76d88fb7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c4dc940>]}
[0m15:07:08.152210 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:07:08.152517 [info ] [MainThread]: 
[0m15:07:08.155127 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:07:08.155651 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:07:08.156127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:07:08.156460 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:07:08.166169 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:07:08.168361 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:07:08.256177 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:07:08.257840 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
'dbt_date' is not a valid S3DataNaming
[0m15:07:08.276649 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 77, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 322, in generate_s3_location
    return mapping[self._s3_data_naming(s3_data_naming)]
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 290, in _s3_data_naming
    return S3DataNaming(s3_data_naming)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/enum.py", line 384, in __call__
    return cls.__new__(cls, value)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/enum.py", line 702, in __new__
    raise ve_exc
ValueError: 'dbt_date' is not a valid S3DataNaming

[0m15:07:08.278370 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '643bc648-0e30-4f9b-9024-11a76d88fb7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a904e50>]}
[0m15:07:08.278967 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbt.new_sales ............................ [[31mERROR[0m in 0.12s]
[0m15:07:08.279485 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:07:08.280443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:08.280749 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:07:08.281029 [info ] [MainThread]: 
[0m15:07:08.281313 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m15:07:08.281856 [debug] [MainThread]: Command end result
[0m15:07:08.313181 [info ] [MainThread]: 
[0m15:07:08.313718 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:07:08.314021 [info ] [MainThread]: 
[0m15:07:08.314375 [error] [MainThread]:   'dbt_date' is not a valid S3DataNaming
[0m15:07:08.315103 [info ] [MainThread]: 
[0m15:07:08.315407 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:07:08.320628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.469472, "process_user_time": 3.359938, "process_kernel_time": 0.530405, "process_mem_max_rss": "152092672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:07:08.321230 [debug] [MainThread]: Command `dbt run` failed at 15:07:08.321148 after 4.47 seconds
[0m15:07:08.321595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f96b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11887bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8abc70>]}
[0m15:07:08.321920 [debug] [MainThread]: Flushing usage events
[0m15:07:20.524768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10239cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e2e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e2eeb0>]}


============================== 15:07:20.558662 | acca2d7c-ac95-4cf9-a7c1-2f8124c7e566 ==============================
[0m15:07:20.558662 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:07:20.560101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:07:21.190478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acca2d7c-ac95-4cf9-a7c1-2f8124c7e566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cbd100>]}
[0m15:07:21.239813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acca2d7c-ac95-4cf9-a7c1-2f8124c7e566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103289970>]}
[0m15:07:21.241256 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:07:21.355930 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:07:21.442838 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:07:21.443335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'acca2d7c-ac95-4cf9-a7c1-2f8124c7e566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103224550>]}
[0m15:07:22.604215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:07:22.615634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acca2d7c-ac95-4cf9-a7c1-2f8124c7e566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649c130>]}
[0m15:07:22.711581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acca2d7c-ac95-4cf9-a7c1-2f8124c7e566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106508670>]}
[0m15:07:22.712189 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:07:22.712508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acca2d7c-ac95-4cf9-a7c1-2f8124c7e566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d3220>]}
[0m15:07:22.713646 [info ] [MainThread]: 
[0m15:07:22.714111 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:07:22.714816 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:07:22.715187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:23.610388 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:07:23.612423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:07:23.613066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:24.905667 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:07:24.906374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acca2d7c-ac95-4cf9-a7c1-2f8124c7e566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acdcc70>]}
[0m15:07:24.906883 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:07:24.907192 [info ] [MainThread]: 
[0m15:07:24.909285 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:07:24.909813 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:07:24.910313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:07:24.910652 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:07:24.919887 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:07:24.920897 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:07:24.985084 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:07:24.987600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:07:25.562597 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:07:25.563331 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
create table "AwsDataCatalog"."dbt"."new_sales"
    with (
      table_type='hive',
      is_external=true,external_location='s3://sample-snapshot-bucket/demodb/date/dbt/new_sales/213bdd3e-93ff-40b8-b3a7-f0a8c7b83516',
      format='parquet'
    )
    as
      with sales as (

    select * from "AwsDataCatalog"."sample_ticket_database"."sales"

),

users as (

    select * from "AwsDataCatalog"."sample_ticket_database"."users"

),

rawdate as (

    select * from "AwsDataCatalog"."sample_ticket_database"."date"

),

new_sales as (
    select
    sellerid,
    username,
    (firstname ||''|| lastname) as name,
    city, 
    sum(qtlsold)

    from sales, rawdate, users
    where sales.sellerid = users.userid
    and sale.dateid = rawdate.dateid
    group by sellerid, username, name, city 
)


select * from new_sales
[0m15:07:26.018246 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6ffcb8c6-c0fe-423c-bc40-ae94abbbb31c
[0m15:07:31.401591 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0cbe7c05-2490-41b6-bade-2a42fc116295
[0m15:07:44.802419 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 83b15776-41d4-437e-a127-90b78a0126b9
[0m15:08:09.616170 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 77c29997-8636-4b0b-8776-36e434561197
[0m15:08:19.127968 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 40dd5c5a-1cce-4675-af90-157d0a29af3f
[0m15:09:22.488602 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c87a478a-218e-4652-a602-8e96092c9976
[0m15:09:23.769322 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: COLUMN_NOT_FOUND: line 34:48: Column 'sale.dateid' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/c87a478a-218e-4652-a602-8e96092c9976' before retrying. Athena will not delete data in your account.
[0m15:09:23.771189 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: Close
[0m15:09:23.773309 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
COLUMN_NOT_FOUND: line 34:48: Column 'sale.dateid' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/c87a478a-218e-4652-a602-8e96092c9976' before retrying. Athena will not delete data in your account.
[0m15:09:23.785905 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1288, in run_query_with_partitions_limit_catching
    raise e
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1284, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1365, in _run_query
    raise e
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1362, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 219, in execute
    return inner()  # type: ignore
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 325, in iter
    raise retry_exc.reraise()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 158, in reraise
    raise self.last_attempt.result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 217, in inner
    return execute_with_iceberg_retries()  # type: ignore
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 215, in execute_with_iceberg_retries
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: COLUMN_NOT_FOUND: line 34:48: Column 'sale.dateid' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/c87a478a-218e-4652-a602-8e96092c9976' before retrying. Athena will not delete data in your account.

[0m15:09:23.801792 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acca2d7c-ac95-4cf9-a7c1-2f8124c7e566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106172880>]}
[0m15:09:23.806235 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbt.new_sales ............................ [[31mERROR[0m in 118.88s]
[0m15:09:23.807186 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:09:23.809882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:23.810274 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:09:23.810671 [info ] [MainThread]: 
[0m15:09:23.811161 [info ] [MainThread]: Finished running 1 table model in 0 hours 2 minutes and 1.10 seconds (121.10s).
[0m15:09:23.812253 [debug] [MainThread]: Command end result
[0m15:09:23.890371 [info ] [MainThread]: 
[0m15:09:23.893156 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:09:23.895024 [info ] [MainThread]: 
[0m15:09:23.897531 [error] [MainThread]:   COLUMN_NOT_FOUND: line 34:48: Column 'sale.dateid' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/c87a478a-218e-4652-a602-8e96092c9976' before retrying. Athena will not delete data in your account.
[0m15:09:23.899919 [info ] [MainThread]: 
[0m15:09:23.902230 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:09:23.915539 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 123.45729, "process_user_time": 3.579836, "process_kernel_time": 0.671885, "process_mem_max_rss": "163528704", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:23.924501 [debug] [MainThread]: Command `dbt run` failed at 15:09:23.924151 after 123.47 seconds
[0m15:09:23.930852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10239cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103289970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be62eb0>]}
[0m15:09:23.936948 [debug] [MainThread]: Flushing usage events
[0m15:11:41.984721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108078a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0274f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a027ee0>]}


============================== 15:11:41.989009 | 82935d55-27cc-4e46-b843-5d99c7ef05bb ==============================
[0m15:11:41.989009 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:11:41.989542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:11:42.620375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82935d55-27cc-4e46-b843-5d99c7ef05bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c18b5b0>]}
[0m15:11:42.668961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82935d55-27cc-4e46-b843-5d99c7ef05bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb2d30>]}
[0m15:11:42.670125 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:11:42.794769 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:11:42.937108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:11:42.937722 [debug] [MainThread]: Partial parsing: updated file: sampletikcetdata://models/new_sales.sql
[0m15:11:43.138785 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:11:43.152189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82935d55-27cc-4e46-b843-5d99c7ef05bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c75d130>]}
[0m15:11:43.249547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82935d55-27cc-4e46-b843-5d99c7ef05bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7aa730>]}
[0m15:11:43.250029 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:11:43.250342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82935d55-27cc-4e46-b843-5d99c7ef05bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c74ad00>]}
[0m15:11:43.251541 [info ] [MainThread]: 
[0m15:11:43.252039 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:11:43.252742 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:11:43.253107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:43.975107 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:11:43.977872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:11:43.978833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:45.159744 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:11:45.160428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82935d55-27cc-4e46-b843-5d99c7ef05bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7b12b0>]}
[0m15:11:45.160936 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:11:45.161243 [info ] [MainThread]: 
[0m15:11:45.163116 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:11:45.163763 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:11:45.164223 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:11:45.164542 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:11:45.174206 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:11:45.175640 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:11:45.237577 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:11:45.238262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:11:45.758556 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:11:45.760486 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
create table "AwsDataCatalog"."dbt"."new_sales"
    with (
      table_type='hive',
      is_external=true,external_location='s3://sample-snapshot-bucket/demodb/date/dbt/new_sales/ed99f678-65b7-4375-babf-01c3eb147697',
      format='parquet'
    )
    as
      with sales as (

    select * from "AwsDataCatalog"."sample_ticket_database"."sales"

),

users as (

    select * from "AwsDataCatalog"."sample_ticket_database"."users"

),

rawdate as (

    select * from "AwsDataCatalog"."sample_ticket_database"."date"

),

new_sales as (
    select
    sellerid,
    username,
    (firstname ||''|| lastname) as name,
    city, 
    sum(qtlsold)

    from sales, rawdate, users
    where sales.sellerid = users.userid
    and sales.dateid = rawdate.dateid
    group by sellerid, username, name, city 
)


select * from new_sales
[0m15:11:46.161773 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 06df0227-7de3-4fa7-bcf4-a053e24f59c0
[0m15:11:49.512567 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6ca48fdf-c84a-45c5-9b4b-bb1d4a43fcbd
[0m15:11:54.732609 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1f9e9e43-eeb8-4efc-b1b3-d213c72f1280
[0m15:12:10.976285 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c77d51b0-7bec-43fe-9b96-a52170828810
[0m15:12:26.927436 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f5e22942-18cc-45f6-a484-aadcb9b46ebb
[0m15:12:42.877615 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ed89b77c-923b-4175-bf97-e85b27e7f02a
[0m15:12:44.152283 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: COLUMN_NOT_FOUND: line 29:10: Column 'qtlsold' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/ed89b77c-923b-4175-bf97-e85b27e7f02a' before retrying. Athena will not delete data in your account.
[0m15:12:44.153701 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: Close
[0m15:12:44.158483 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
COLUMN_NOT_FOUND: line 29:10: Column 'qtlsold' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/ed89b77c-923b-4175-bf97-e85b27e7f02a' before retrying. Athena will not delete data in your account.
[0m15:12:44.186539 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1288, in run_query_with_partitions_limit_catching
    raise e
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1284, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1365, in _run_query
    raise e
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1362, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 219, in execute
    return inner()  # type: ignore
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 325, in iter
    raise retry_exc.reraise()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 158, in reraise
    raise self.last_attempt.result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 217, in inner
    return execute_with_iceberg_retries()  # type: ignore
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 215, in execute_with_iceberg_retries
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: COLUMN_NOT_FOUND: line 29:10: Column 'qtlsold' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/ed89b77c-923b-4175-bf97-e85b27e7f02a' before retrying. Athena will not delete data in your account.

[0m15:12:44.192602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82935d55-27cc-4e46-b843-5d99c7ef05bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e03a370>]}
[0m15:12:44.194231 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbt.new_sales ............................ [[31mERROR[0m in 59.02s]
[0m15:12:44.195147 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:12:44.199378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:44.200457 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:12:44.201436 [info ] [MainThread]: 
[0m15:12:44.203778 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 0.95 seconds (60.95s).
[0m15:12:44.208171 [debug] [MainThread]: Command end result
[0m15:12:44.392436 [info ] [MainThread]: 
[0m15:12:44.392933 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:12:44.393226 [info ] [MainThread]: 
[0m15:12:44.393573 [error] [MainThread]:   COLUMN_NOT_FOUND: line 29:10: Column 'qtlsold' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/ed89b77c-923b-4175-bf97-e85b27e7f02a' before retrying. Athena will not delete data in your account.
[0m15:12:44.393851 [info ] [MainThread]: 
[0m15:12:44.394145 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:12:44.396478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 62.48881, "process_user_time": 2.786023, "process_kernel_time": 0.636437, "process_mem_max_rss": "187793408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:12:44.397003 [debug] [MainThread]: Command `dbt run` failed at 15:12:44.396917 after 62.49 seconds
[0m15:12:44.397364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108078a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb2d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a2c220>]}
[0m15:12:44.397702 [debug] [MainThread]: Flushing usage events
[0m15:13:25.410638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119018a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8aebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8ae1c0>]}


============================== 15:13:25.414955 | 8bddfc41-795e-4fb5-b7db-1ef423c6531a ==============================
[0m15:13:25.414955 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:13:25.415547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:13:26.020136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bddfc41-795e-4fb5-b7db-1ef423c6531a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c9f7d30>]}
[0m15:13:26.068732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bddfc41-795e-4fb5-b7db-1ef423c6531a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1ba160>]}
[0m15:13:26.070083 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:13:26.191610 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:13:26.332255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:26.332937 [debug] [MainThread]: Partial parsing: updated file: sampletikcetdata://models/new_sales.sql
[0m15:13:26.531758 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:13:26.545632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bddfc41-795e-4fb5-b7db-1ef423c6531a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d621130>]}
[0m15:13:26.643125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bddfc41-795e-4fb5-b7db-1ef423c6531a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d5f3130>]}
[0m15:13:26.643638 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:13:26.643961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bddfc41-795e-4fb5-b7db-1ef423c6531a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4b5460>]}
[0m15:13:26.645222 [info ] [MainThread]: 
[0m15:13:26.645719 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:13:26.646442 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:13:26.646827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:27.345067 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:13:27.347792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:13:27.348698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:28.541428 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:13:28.542108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bddfc41-795e-4fb5-b7db-1ef423c6531a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1941c0>]}
[0m15:13:28.542600 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:13:28.542902 [info ] [MainThread]: 
[0m15:13:28.545379 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:13:28.546091 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:13:28.546603 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:13:28.546950 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:13:28.556172 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:13:28.558010 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:13:28.619760 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:13:28.620441 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:29.159341 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:13:29.160850 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
create table "AwsDataCatalog"."dbt"."new_sales"
    with (
      table_type='hive',
      is_external=true,external_location='s3://sample-snapshot-bucket/demodb/date/dbt/new_sales/616006f0-da45-4035-9d35-50c963b78d38',
      format='parquet'
    )
    as
      with sales as (

    select * from "AwsDataCatalog"."sample_ticket_database"."sales"

),

users as (

    select * from "AwsDataCatalog"."sample_ticket_database"."users"

),

rawdate as (

    select * from "AwsDataCatalog"."sample_ticket_database"."date"

),

new_sales as (
    select
    sellerid,
    username,
    (firstname ||''|| lastname) as name,
    city, 
    sum(qtysold)

    from sales, rawdate, users
    where sales.sellerid = users.userid
    and sales.dateid = rawdate.dateid
    group by sellerid, username, name, city 
)


select * from new_sales
[0m15:13:29.554465 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 72d68ab0-0009-4749-9266-33059ac6ec47
[0m15:13:31.277159 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 541c0a23-14e1-4c18-8cc8-f3351e8976d2
[0m15:13:44.539906 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID dcd9851e-b73a-477d-aaeb-a86a03a8b6aa
[0m15:13:50.098870 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3e1c279e-e0f8-4b15-a475-ca71087fdc6b
[0m15:14:16.519217 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0cfcac5a-814e-4802-9a32-92bfc099ae8f
[0m15:14:56.781844 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c655c87f-9bea-44ea-8880-9502a388195b
[0m15:14:58.060794 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: COLUMN_NOT_FOUND: line 35:33: Column 'name' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/c655c87f-9bea-44ea-8880-9502a388195b' before retrying. Athena will not delete data in your account.
[0m15:14:58.062298 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: Close
[0m15:14:58.063843 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
COLUMN_NOT_FOUND: line 35:33: Column 'name' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/c655c87f-9bea-44ea-8880-9502a388195b' before retrying. Athena will not delete data in your account.
[0m15:14:58.073088 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1288, in run_query_with_partitions_limit_catching
    raise e
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1284, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1365, in _run_query
    raise e
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1362, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 219, in execute
    return inner()  # type: ignore
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 325, in iter
    raise retry_exc.reraise()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 158, in reraise
    raise self.last_attempt.result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 217, in inner
    return execute_with_iceberg_retries()  # type: ignore
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 215, in execute_with_iceberg_retries
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: COLUMN_NOT_FOUND: line 35:33: Column 'name' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/c655c87f-9bea-44ea-8880-9502a388195b' before retrying. Athena will not delete data in your account.

[0m15:14:58.077477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bddfc41-795e-4fb5-b7db-1ef423c6531a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f79e3a0>]}
[0m15:14:58.085479 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbt.new_sales ............................ [[31mERROR[0m in 89.53s]
[0m15:14:58.086376 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:14:58.088804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:58.089324 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:14:58.089838 [info ] [MainThread]: 
[0m15:14:58.090226 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 31.44 seconds (91.44s).
[0m15:14:58.091174 [debug] [MainThread]: Command end result
[0m15:14:58.288355 [info ] [MainThread]: 
[0m15:14:58.288825 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:14:58.289116 [info ] [MainThread]: 
[0m15:14:58.289468 [error] [MainThread]:   COLUMN_NOT_FOUND: line 35:33: Column 'name' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/c655c87f-9bea-44ea-8880-9502a388195b' before retrying. Athena will not delete data in your account.
[0m15:14:58.289751 [info ] [MainThread]: 
[0m15:14:58.290039 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:14:58.291997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 92.95628, "process_user_time": 2.760247, "process_kernel_time": 0.658064, "process_mem_max_rss": "186957824", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:14:58.292541 [debug] [MainThread]: Command `dbt run` failed at 15:14:58.292454 after 92.96 seconds
[0m15:14:58.292912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119018a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b82fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7a5850>]}
[0m15:14:58.293261 [debug] [MainThread]: Flushing usage events
[0m15:17:40.303016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102575ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452beb0>]}


============================== 15:17:40.307244 | 69e33e44-59a9-4b23-8315-38055f8ba032 ==============================
[0m15:17:40.307244 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:17:40.307786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:17:40.972006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69e33e44-59a9-4b23-8315-38055f8ba032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b9100>]}
[0m15:17:41.020005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69e33e44-59a9-4b23-8315-38055f8ba032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103585970>]}
[0m15:17:41.021104 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:17:41.135037 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:17:41.277964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:41.278582 [debug] [MainThread]: Partial parsing: updated file: sampletikcetdata://models/new_sales.sql
[0m15:17:41.484326 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:17:41.497597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69e33e44-59a9-4b23-8315-38055f8ba032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10735f130>]}
[0m15:17:41.593955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69e33e44-59a9-4b23-8315-38055f8ba032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070db490>]}
[0m15:17:41.594449 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:17:41.594770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69e33e44-59a9-4b23-8315-38055f8ba032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a5a90>]}
[0m15:17:41.595992 [info ] [MainThread]: 
[0m15:17:41.596472 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:17:41.597182 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:17:41.597549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:42.311793 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:17:42.314258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:17:42.314951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:43.537061 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:17:43.539486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69e33e44-59a9-4b23-8315-38055f8ba032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706c160>]}
[0m15:17:43.541053 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:17:43.541922 [info ] [MainThread]: 
[0m15:17:43.546348 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:17:43.547572 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:17:43.548750 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:17:43.549402 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:17:43.565217 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:17:43.566511 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:17:43.632394 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:17:43.633069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:17:44.139608 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:17:44.140326 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
create table "AwsDataCatalog"."dbt"."new_sales"
    with (
      table_type='hive',
      is_external=true,external_location='s3://sample-snapshot-bucket/demodb/date/dbt/new_sales/4a37fca0-7260-41d6-9632-cd1f8f3e78cc',
      format='parquet'
    )
    as
      with sales as (

    select * from "AwsDataCatalog"."sample_ticket_database"."sales"

),

users as (

    select * from "AwsDataCatalog"."sample_ticket_database"."users"

),

rawdate as (

    select * from "AwsDataCatalog"."sample_ticket_database"."date"

),

new_sales as (
    select
    sellerid,
    username,
    (firstname ||''|| lastname) as name,
    city, 
    sum(qtysold)

    from sales, rawdate, users
    where sales.sellerid = users.userid
    and sales.dateid = rawdate.dateid
    group by sellerid, username, city 
)


select * from new_sales
[0m15:17:44.538748 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a992bad0-2c06-40ae-bfc7-1bc1c1d2eede
[0m15:17:51.802481 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fbe27a98-e5c4-42b0-aaf6-b0bbe99dc135
[0m15:18:04.138052 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID de7d765c-df76-407d-93a3-71ff3e291dcb
[0m15:18:13.631649 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID edf8123a-d29f-4d83-b17d-8fc45a7538fb
[0m15:18:29.787219 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 45dca0bd-fcfa-44d2-a3a8-0576e5e99ece
[0m15:19:11.364728 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f373655d-12bf-4cbd-9991-c06d99f3cf91
[0m15:19:12.635528 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: EXPRESSION_NOT_AGGREGATE: line 27:6: 'concat(concat(firstname, ''), lastname)' must be an aggregate expression or appear in GROUP BY clause. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/f373655d-12bf-4cbd-9991-c06d99f3cf91' before retrying. Athena will not delete data in your account.
[0m15:19:12.637427 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: Close
[0m15:19:12.639257 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
EXPRESSION_NOT_AGGREGATE: line 27:6: 'concat(concat(firstname, ''), lastname)' must be an aggregate expression or appear in GROUP BY clause. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/f373655d-12bf-4cbd-9991-c06d99f3cf91' before retrying. Athena will not delete data in your account.
[0m15:19:12.651759 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1288, in run_query_with_partitions_limit_catching
    raise e
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1284, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1365, in _run_query
    raise e
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1362, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 219, in execute
    return inner()  # type: ignore
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 325, in iter
    raise retry_exc.reraise()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 158, in reraise
    raise self.last_attempt.result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 217, in inner
    return execute_with_iceberg_retries()  # type: ignore
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 215, in execute_with_iceberg_retries
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: EXPRESSION_NOT_AGGREGATE: line 27:6: 'concat(concat(firstname, ''), lastname)' must be an aggregate expression or appear in GROUP BY clause. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/f373655d-12bf-4cbd-9991-c06d99f3cf91' before retrying. Athena will not delete data in your account.

[0m15:19:12.657017 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69e33e44-59a9-4b23-8315-38055f8ba032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2c430>]}
[0m15:19:12.658838 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbt.new_sales ............................ [[31mERROR[0m in 89.10s]
[0m15:19:12.659834 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:19:12.662434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:12.662859 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:19:12.663308 [info ] [MainThread]: 
[0m15:19:12.663767 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 31.07 seconds (91.07s).
[0m15:19:12.665653 [debug] [MainThread]: Command end result
[0m15:19:12.863365 [info ] [MainThread]: 
[0m15:19:12.863831 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:19:12.864114 [info ] [MainThread]: 
[0m15:19:12.864461 [error] [MainThread]:   EXPRESSION_NOT_AGGREGATE: line 27:6: 'concat(concat(firstname, ''), lastname)' must be an aggregate expression or appear in GROUP BY clause. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/f373655d-12bf-4cbd-9991-c06d99f3cf91' before retrying. Athena will not delete data in your account.
[0m15:19:12.864740 [info ] [MainThread]: 
[0m15:19:12.865035 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:19:12.867062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 92.64109, "process_user_time": 2.780834, "process_kernel_time": 0.670843, "process_mem_max_rss": "190742528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:19:12.867577 [debug] [MainThread]: Command `dbt run` failed at 15:19:12.867493 after 92.64 seconds
[0m15:19:12.867922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102575ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b09d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b9100>]}
[0m15:19:12.868243 [debug] [MainThread]: Flushing usage events
[0m15:19:36.844110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aec9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aab400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aabdf0>]}


============================== 15:19:36.848873 | 80698d2d-2473-404a-a8a4-010b3444854b ==============================
[0m15:19:36.848873 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:19:36.849460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:19:37.536191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80698d2d-2473-404a-a8a4-010b3444854b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7c5e0>]}
[0m15:19:37.591916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80698d2d-2473-404a-a8a4-010b3444854b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7c040>]}
[0m15:19:37.593684 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:19:37.712372 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:19:37.849660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:19:37.850324 [debug] [MainThread]: Partial parsing: updated file: sampletikcetdata://models/new_sales.sql
[0m15:19:38.055497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:19:38.069544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80698d2d-2473-404a-a8a4-010b3444854b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11179f130>]}
[0m15:19:38.170280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80698d2d-2473-404a-a8a4-010b3444854b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117e6790>]}
[0m15:19:38.170775 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:19:38.171091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80698d2d-2473-404a-a8a4-010b3444854b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11178bbe0>]}
[0m15:19:38.172330 [info ] [MainThread]: 
[0m15:19:38.172804 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:19:38.173514 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:19:38.173883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:38.881649 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:19:38.882772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:19:38.883299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:40.297297 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:19:40.297973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80698d2d-2473-404a-a8a4-010b3444854b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111274d00>]}
[0m15:19:40.298474 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:19:40.298780 [info ] [MainThread]: 
[0m15:19:40.301170 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:19:40.301934 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:19:40.302563 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:19:40.302990 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:19:40.311693 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:19:40.313896 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:19:40.380678 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:19:40.381353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:40.880517 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:19:40.881734 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
create table "AwsDataCatalog"."dbt"."new_sales"
    with (
      table_type='hive',
      is_external=true,external_location='s3://sample-snapshot-bucket/demodb/date/dbt/new_sales/16333ab3-bda4-4fee-bf49-36f72d17a907',
      format='parquet'
    )
    as
      with sales as (

    select * from "AwsDataCatalog"."sample_ticket_database"."sales"

),

users as (

    select * from "AwsDataCatalog"."sample_ticket_database"."users"

),

rawdate as (

    select * from "AwsDataCatalog"."sample_ticket_database"."date"

),

new_sales as (
    select
    sellerid,
    username,
    (firstname ||''|| lastname) as name,
    city, 
    sum(qtysold)

    from sales, rawdate, users
    where sales.sellerid = users.userid
    and sales.dateid = rawdate.dateid
    group by sellerid, username, name, city
    order by 5 desc;
)


select * from new_sales
[0m15:21:17.103134 [error] [MainThread]: CANCEL query model.sampletikcetdata.new_sales .................................. [[31mCANCEL[0m]
[0m15:21:25.853558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:25.854239 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was left open.
[0m15:21:25.854669 [debug] [MainThread]: On model.sampletikcetdata.new_sales: Close
[0m15:21:25.855181 [info ] [MainThread]: 
[0m15:21:25.855625 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 47.68 seconds (107.68s).
[0m15:21:25.856260 [error] [MainThread]: Encountered an error:

[0m15:21:25.861802 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/runnable.py", line 397, in execute_nodes
    self.run_queue(pool)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/runnable.py", line 315, in run_queue
    self.job_queue.join()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/threading.py", line 312, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/runnable.py", line 487, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/runnable.py", line 422, in execute_nodes
    self._cancel_connections(pool)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/runnable.py", line 379, in _cancel_connections
    pool.join()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/multiprocessing/pool.py", line 666, in join
    p.join()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/threading.py", line 1060, in join
    self._wait_for_tstate_lock()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/threading.py", line 1080, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt

[0m15:21:25.865270 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 109.10313, "process_user_time": 2.590686, "process_kernel_time": 0.664834, "process_mem_max_rss": "181174272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:21:25.866151 [debug] [MainThread]: Command `dbt run` failed at 15:21:25.866030 after 109.10 seconds
[0m15:21:25.866690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aec9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f6820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13058eb80>]}
[0m15:21:25.867437 [debug] [MainThread]: Flushing usage events
[0m15:21:29.555220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f98a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d274c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d27eb0>]}


============================== 15:21:29.559263 | cbfd3d9f-53f3-4b86-a24f-f558a7f5f64f ==============================
[0m15:21:29.559263 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:21:29.559806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:30.162464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbfd3d9f-53f3-4b86-a24f-f558a7f5f64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d3190>]}
[0m15:21:30.210466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbfd3d9f-53f3-4b86-a24f-f558a7f5f64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cbb2b0>]}
[0m15:21:30.211615 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:21:30.325974 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:21:30.463165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:30.463771 [debug] [MainThread]: Partial parsing: updated file: sampletikcetdata://models/new_sales.sql
[0m15:21:30.664081 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:21:30.677443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbfd3d9f-53f3-4b86-a24f-f558a7f5f64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd60130>]}
[0m15:21:30.774969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbfd3d9f-53f3-4b86-a24f-f558a7f5f64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc150d0>]}
[0m15:21:30.775490 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:21:30.775806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbfd3d9f-53f3-4b86-a24f-f558a7f5f64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd6d760>]}
[0m15:21:30.777015 [info ] [MainThread]: 
[0m15:21:30.777494 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:21:30.778197 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:21:30.778581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:31.455956 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:21:31.458891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:21:31.459657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:32.788940 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:21:32.789868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbfd3d9f-53f3-4b86-a24f-f558a7f5f64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073eefd0>]}
[0m15:21:32.790631 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:21:32.791383 [info ] [MainThread]: 
[0m15:21:32.794171 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:21:32.795091 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:21:32.795976 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:21:32.796390 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:21:32.808539 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:21:32.810328 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:21:32.870856 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:21:32.871505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:21:33.399817 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:21:33.401134 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
create table "AwsDataCatalog"."dbt"."new_sales"
    with (
      table_type='hive',
      is_external=true,external_location='s3://sample-snapshot-bucket/demodb/date/dbt/new_sales/6a415c6c-1f53-457c-917a-eb3a86f38ddb',
      format='parquet'
    )
    as
      with sales as (

    select * from "AwsDataCatalog"."sample_ticket_database"."sales"

),

users as (

    select * from "AwsDataCatalog"."sample_ticket_database"."users"

),

rawdate as (

    select * from "AwsDataCatalog"."sample_ticket_database"."date"

),

new_sales as (
    select
    sellerid,
    username,
    (firstname ||''|| lastname) as name,
    city, 
    sum(qtysold)

    from sales, rawdate, users
    where sales.sellerid = users.userid
    and sales.dateid = rawdate.dateid
    group by sellerid, username, name, city
   
)


select * from new_sales
[0m15:21:33.818490 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 832f1db6-502d-4ce1-8ce9-12b4a4df79b2
[0m15:21:37.054321 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 298fffef-75d2-4ae1-88fc-2ef4d800a91e
[0m15:21:45.771006 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4b48039b-9b79-4609-81c1-eb78cd0722ac
[0m15:22:00.749185 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 834f50ca-60f9-4a31-8d8f-f20b5b14aa15
[0m15:22:27.922966 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9da2f093-8b22-477e-a4bf-3c25aa960181
[0m15:23:02.418746 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e60db5b1-07b7-4f4a-b6a9-f6781bc2fbc1
[0m15:23:03.688140 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: COLUMN_NOT_FOUND: line 35:33: Column 'name' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/e60db5b1-07b7-4f4a-b6a9-f6781bc2fbc1' before retrying. Athena will not delete data in your account.
[0m15:23:03.689212 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: Close
[0m15:23:03.690453 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
COLUMN_NOT_FOUND: line 35:33: Column 'name' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/e60db5b1-07b7-4f4a-b6a9-f6781bc2fbc1' before retrying. Athena will not delete data in your account.
[0m15:23:03.708785 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1288, in run_query_with_partitions_limit_catching
    raise e
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1284, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1365, in _run_query
    raise e
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1362, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 219, in execute
    return inner()  # type: ignore
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 325, in iter
    raise retry_exc.reraise()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 158, in reraise
    raise self.last_attempt.result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 217, in inner
    return execute_with_iceberg_retries()  # type: ignore
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 215, in execute_with_iceberg_retries
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: COLUMN_NOT_FOUND: line 35:33: Column 'name' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/e60db5b1-07b7-4f4a-b6a9-f6781bc2fbc1' before retrying. Athena will not delete data in your account.

[0m15:23:03.712549 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbfd3d9f-53f3-4b86-a24f-f558a7f5f64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e72a3d0>]}
[0m15:23:03.714058 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbt.new_sales ............................ [[31mERROR[0m in 90.91s]
[0m15:23:03.714917 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:23:03.717027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:03.717371 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:23:03.717711 [info ] [MainThread]: 
[0m15:23:03.718051 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 32.94 seconds (92.94s).
[0m15:23:03.718913 [debug] [MainThread]: Command end result
[0m15:23:03.936215 [info ] [MainThread]: 
[0m15:23:03.936733 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:23:03.937055 [info ] [MainThread]: 
[0m15:23:03.937450 [error] [MainThread]:   COLUMN_NOT_FOUND: line 35:33: Column 'name' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/e60db5b1-07b7-4f4a-b6a9-f6781bc2fbc1' before retrying. Athena will not delete data in your account.
[0m15:23:03.937769 [info ] [MainThread]: 
[0m15:23:03.938096 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:23:03.940682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 94.45936, "process_user_time": 2.781704, "process_kernel_time": 0.64824, "process_mem_max_rss": "183009280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:23:03.941301 [debug] [MainThread]: Command `dbt run` failed at 15:23:03.941203 after 94.46 seconds
[0m15:23:03.942084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f98a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108085dc0>]}
[0m15:23:03.942892 [debug] [MainThread]: Flushing usage events
[0m15:23:18.369239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106196af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11082e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11082eee0>]}


============================== 15:23:18.373418 | b3c6a50c-458e-4a15-a683-4c14690443db ==============================
[0m15:23:18.373418 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:23:18.373948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:23:19.012364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3c6a50c-458e-4a15-a683-4c14690443db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a334f0>]}
[0m15:23:19.059760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3c6a50c-458e-4a15-a683-4c14690443db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eaea00>]}
[0m15:23:19.061047 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:23:19.174122 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:23:19.314516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:23:19.315143 [debug] [MainThread]: Partial parsing: updated file: sampletikcetdata://models/new_sales.sql
[0m15:23:19.520207 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:23:19.534193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3c6a50c-458e-4a15-a683-4c14690443db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11265d130>]}
[0m15:23:19.632438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3c6a50c-458e-4a15-a683-4c14690443db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124db310>]}
[0m15:23:19.632935 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:23:19.633254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3c6a50c-458e-4a15-a683-4c14690443db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126a3a90>]}
[0m15:23:19.634535 [info ] [MainThread]: 
[0m15:23:19.635052 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:23:19.635765 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:23:19.636141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:20.322547 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:23:20.324046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:23:20.324509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:21.568780 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:23:21.569418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3c6a50c-458e-4a15-a683-4c14690443db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c5a90>]}
[0m15:23:21.569916 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:23:21.570221 [info ] [MainThread]: 
[0m15:23:21.572556 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:23:21.573266 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:23:21.574293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:23:21.574972 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:23:21.588133 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:23:21.589010 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:23:21.662345 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:23:21.663081 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:23:22.166139 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:23:22.169149 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
create table "AwsDataCatalog"."dbt"."new_sales"
    with (
      table_type='hive',
      is_external=true,external_location='s3://sample-snapshot-bucket/demodb/date/dbt/new_sales/a9309d6e-9393-4142-b78a-26018b5ec2f8',
      format='parquet'
    )
    as
      with sales as (

    select * from "AwsDataCatalog"."sample_ticket_database"."sales"

),

users as (

    select * from "AwsDataCatalog"."sample_ticket_database"."users"

),

rawdate as (

    select * from "AwsDataCatalog"."sample_ticket_database"."date"

),

new_sales as (
    select
        sellerid,
        username,
        -- (firstname ||''|| lastname) as name,
        city, 
        sum(qtysold)

    from sales, rawdate, users
    where sales.sellerid = users.userid
    and sales.dateid = rawdate.dateid
    group by sellerid, username, city
   
)


select * from new_sales
[0m15:23:22.612115 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 98e58286-7cf7-42a4-976d-f97b9fa3d9fd
[0m15:23:25.675152 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d1d86cdb-f834-463b-a099-80da570070f6
[0m15:23:30.391919 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 179538ef-ec9e-457b-8d3f-7c0960dfb2ea
[0m15:23:37.873900 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fb80bf46-e925-4f2e-bd41-3b56d26dec19
[0m15:23:44.323871 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 76ca3ae8-15d7-4ecf-8376-c0c9c8eaf597
[0m15:24:28.317467 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 816d44ad-8927-484e-83f5-9fed09e5803a
[0m15:24:29.582586 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: MISSING_COLUMN_NAME: line 1:1: Column name not specified at position 4. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/816d44ad-8927-484e-83f5-9fed09e5803a' before retrying. Athena will not delete data in your account.
[0m15:24:29.589701 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: Close
[0m15:24:29.599102 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
MISSING_COLUMN_NAME: line 1:1: Column name not specified at position 4. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/816d44ad-8927-484e-83f5-9fed09e5803a' before retrying. Athena will not delete data in your account.
[0m15:24:29.621053 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 768, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 782, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/sandbox.py", line 394, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1288, in run_query_with_partitions_limit_catching
    raise e
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1284, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1365, in _run_query
    raise e
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/impl.py", line 1362, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 219, in execute
    return inner()  # type: ignore
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 325, in iter
    raise retry_exc.reraise()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 158, in reraise
    raise self.last_attempt.result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 217, in inner
    return execute_with_iceberg_retries()  # type: ignore
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 439, in result
    return self.__get_result()
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/concurrent/futures/_base.py", line 391, in __get_result
    raise self._exception
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/Users/koukish/.pyenv/versions/3.9.17/lib/python3.9/site-packages/dbt/adapters/athena/connections.py", line 215, in execute_with_iceberg_retries
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: MISSING_COLUMN_NAME: line 1:1: Column name not specified at position 4. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/816d44ad-8927-484e-83f5-9fed09e5803a' before retrying. Athena will not delete data in your account.

[0m15:24:29.627510 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c6a50c-458e-4a15-a683-4c14690443db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11481a430>]}
[0m15:24:29.642623 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbt.new_sales ............................ [[31mERROR[0m in 68.05s]
[0m15:24:29.648739 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:24:29.659047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:29.660623 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:24:29.661587 [info ] [MainThread]: 
[0m15:24:29.662407 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 10.03 seconds (70.03s).
[0m15:24:29.664373 [debug] [MainThread]: Command end result
[0m15:24:29.872966 [info ] [MainThread]: 
[0m15:24:29.873457 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:24:29.873744 [info ] [MainThread]: 
[0m15:24:29.874093 [error] [MainThread]:   MISSING_COLUMN_NAME: line 1:1: Column name not specified at position 4. You may need to manually clean the data at location 's3://athena-query-result-953891383645/result-data/tables/816d44ad-8927-484e-83f5-9fed09e5803a' before retrying. Athena will not delete data in your account.
[0m15:24:29.874371 [info ] [MainThread]: 
[0m15:24:29.874657 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:24:29.877008 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 71.58141, "process_user_time": 2.753986, "process_kernel_time": 0.677228, "process_mem_max_rss": "172212224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:24:29.877538 [debug] [MainThread]: Command `dbt run` failed at 15:24:29.877452 after 71.58 seconds
[0m15:24:29.877882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106196af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eaea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152fea60>]}
[0m15:24:29.878218 [debug] [MainThread]: Flushing usage events
[0m15:24:59.504677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104754ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e64f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e6ee0>]}


============================== 15:24:59.509001 | 03ec7a1d-4d63-44dd-8a6b-1d82e14b2865 ==============================
[0m15:24:59.509001 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:24:59.509675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:25:00.129408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03ec7a1d-4d63-44dd-8a6b-1d82e14b2865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782ddf0>]}
[0m15:25:00.178710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03ec7a1d-4d63-44dd-8a6b-1d82e14b2865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee8340>]}
[0m15:25:00.180349 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:25:00.294969 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:25:00.438111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:00.438753 [debug] [MainThread]: Partial parsing: updated file: sampletikcetdata://models/new_sales.sql
[0m15:25:00.644224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:25:00.657222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03ec7a1d-4d63-44dd-8a6b-1d82e14b2865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110320130>]}
[0m15:25:00.827954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03ec7a1d-4d63-44dd-8a6b-1d82e14b2865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11019b700>]}
[0m15:25:00.828463 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:25:00.828785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03ec7a1d-4d63-44dd-8a6b-1d82e14b2865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102696a0>]}
[0m15:25:00.830052 [info ] [MainThread]: 
[0m15:25:00.830544 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:25:00.831263 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:25:00.831640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:01.529920 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:25:01.531410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_dbt)
[0m15:25:01.531912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:02.788859 [debug] [ThreadPool]: On list_AwsDataCatalog_dbt: Close
[0m15:25:02.789676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03ec7a1d-4d63-44dd-8a6b-1d82e14b2865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f86760>]}
[0m15:25:02.790313 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:25:02.790701 [info ] [MainThread]: 
[0m15:25:02.793284 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:25:02.794108 [info ] [Thread-1  ]: 1 of 1 START sql table model dbt.new_sales ..................................... [RUN]
[0m15:25:02.794677 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_dbt, now model.sampletikcetdata.new_sales)
[0m15:25:02.795052 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:25:02.808117 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:25:02.809521 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:25:02.884902 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:25:02.885665 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:25:03.467464 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:25:03.468166 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
create table "AwsDataCatalog"."dbt"."new_sales"
    with (
      table_type='hive',
      is_external=true,external_location='s3://sample-snapshot-bucket/demodb/date/dbt/new_sales/c182bc8e-5ed0-4de0-bf1f-3aa6d28027c2',
      format='parquet'
    )
    as
      with sales as (

    select * from "AwsDataCatalog"."sample_ticket_database"."sales"

),

users as (

    select * from "AwsDataCatalog"."sample_ticket_database"."users"

),

rawdate as (

    select * from "AwsDataCatalog"."sample_ticket_database"."date"

),

new_sales as (
    select
        sellerid,
        username,
        -- (firstname ||''|| lastname) as name,
        city, 
        sum(qtysold) as qtysoldsum

    from sales, rawdate, users
    where sales.sellerid = users.userid
    and sales.dateid = rawdate.dateid
    group by sellerid, username, city
   
)


select * from new_sales
[0m15:25:03.843830 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 09c3f03a-91c5-421c-9782-f68ffedfc7c5
[0m15:25:07.670522 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":43435,"data_scanned_in_bytes":2227733}
[0m15:25:07.677887 [debug] [Thread-1  ]: Using athena connection "model.sampletikcetdata.new_sales"
[0m15:25:07.678386 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: alter table `dbt`.`new_sales` set tblproperties ('classification' = 'parquet')
[0m15:25:07.838344 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 645479ab-6841-4678-b35f-1a6c898f8d43
[0m15:25:09.400011 [debug] [Thread-1  ]: SQL status: OK -1 in 1.721 seconds
[0m15:25:09.405225 [debug] [Thread-1  ]: Writing runtime sql for node "model.sampletikcetdata.new_sales"
[0m15:25:09.408358 [debug] [Thread-1  ]: Using athena connection "model.sampletikcetdata.new_sales"
[0m15:25:09.409116 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
SELECT '{"rowcount":43435,"data_scanned_in_bytes":2227733}';
[0m15:25:09.585141 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID cf55e41c-edab-4946-bbdf-61b6ffe73ea6
[0m15:25:11.151521 [debug] [Thread-1  ]: SQL status: OK 43435 in 1.742 seconds
[0m15:25:11.167902 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: Close
[0m15:25:11.169278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ec7a1d-4d63-44dd-8a6b-1d82e14b2865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106472370>]}
[0m15:25:11.169848 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dbt.new_sales ................................ [[32mOK 43435[0m in 8.37s]
[0m15:25:11.170386 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:25:11.171309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:11.171580 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:25:11.173145 [info ] [MainThread]: 
[0m15:25:11.173459 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.34 seconds (10.34s).
[0m15:25:11.174017 [debug] [MainThread]: Command end result
[0m15:25:11.287584 [info ] [MainThread]: 
[0m15:25:11.288097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:11.288395 [info ] [MainThread]: 
[0m15:25:11.288688 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:25:11.290790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.857929, "process_user_time": 3.002903, "process_kernel_time": 0.653683, "process_mem_max_rss": "183566336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:25:11.291324 [debug] [MainThread]: Command `dbt run` succeeded at 15:25:11.291239 after 11.86 seconds
[0m15:25:11.291670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104754ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bb520>]}
[0m15:25:11.291998 [debug] [MainThread]: Flushing usage events
[0m15:30:16.237216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093674c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109367eb0>]}


============================== 15:30:16.241557 | 71f8cee1-5fb8-4251-a6c3-135e70318b91 ==============================
[0m15:30:16.241557 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:30:16.242127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:30:16.852819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71f8cee1-5fb8-4251-a6c3-135e70318b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f9100>]}
[0m15:30:16.900957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71f8cee1-5fb8-4251-a6c3-135e70318b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c5970>]}
[0m15:30:16.902208 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:30:17.019519 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:30:17.107375 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:30:17.107875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '71f8cee1-5fb8-4251-a6c3-135e70318b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865d550>]}
[0m15:30:18.267929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:30:18.279494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71f8cee1-5fb8-4251-a6c3-135e70318b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3dc130>]}
[0m15:30:18.377844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71f8cee1-5fb8-4251-a6c3-135e70318b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d449c10>]}
[0m15:30:18.378433 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:30:18.378746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71f8cee1-5fb8-4251-a6c3-135e70318b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d413eb0>]}
[0m15:30:18.379840 [info ] [MainThread]: 
[0m15:30:18.380298 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:30:18.380998 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:30:18.381364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:19.037623 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:30:19.040619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_sample_ticket_database)
[0m15:30:19.041772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:20.504573 [debug] [ThreadPool]: On list_AwsDataCatalog_sample_ticket_database: Close
[0m15:30:20.507759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71f8cee1-5fb8-4251-a6c3-135e70318b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd1d8e0>]}
[0m15:30:20.508689 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:30:20.509241 [info ] [MainThread]: 
[0m15:30:20.535410 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:30:20.556388 [info ] [Thread-1  ]: 1 of 1 START sql table model sample_ticket_database.new_sales .................. [RUN]
[0m15:30:20.559547 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_sample_ticket_database, now model.sampletikcetdata.new_sales)
[0m15:30:20.565469 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:30:20.584483 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:30:20.586072 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:30:20.648749 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:30:20.649429 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:30:21.169039 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:30:21.171136 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
create table "AwsDataCatalog"."sample_ticket_database"."new_sales"
    with (
      table_type='hive',
      is_external=true,external_location='s3://sample-snapshot-bucket/demodb/date/sample_ticket_database/new_sales/f6695067-26b3-4b87-bf72-2654975c4eed',
      format='parquet'
    )
    as
      with sales as (

    select * from "AwsDataCatalog"."sample_ticket_database"."sales"

),

users as (

    select * from "AwsDataCatalog"."sample_ticket_database"."users"

),

rawdate as (

    select * from "AwsDataCatalog"."sample_ticket_database"."date"

),

new_sales as (
    select
        sellerid,
        username,
        -- (firstname ||''|| lastname) as name,
        city, 
        sum(qtysold) as qtysoldsum

    from sales, rawdate, users
    where sales.sellerid = users.userid
    and sales.dateid = rawdate.dateid
    group by sellerid, username, city
   
)


select * from new_sales
[0m15:30:21.612893 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 43da5e46-4f4a-4316-8fe7-121b937f23d6
[0m15:30:25.396642 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":43435,"data_scanned_in_bytes":2227733}
[0m15:30:25.403445 [debug] [Thread-1  ]: Using athena connection "model.sampletikcetdata.new_sales"
[0m15:30:25.403847 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: alter table `sample_ticket_database`.`new_sales` set tblproperties ('classification' = 'parquet')
[0m15:30:25.565085 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 34755f12-c842-44c9-9ac5-56087392b45f
[0m15:30:27.103675 [debug] [Thread-1  ]: SQL status: OK -1 in 1.699 seconds
[0m15:30:27.108226 [debug] [Thread-1  ]: Writing runtime sql for node "model.sampletikcetdata.new_sales"
[0m15:30:27.111501 [debug] [Thread-1  ]: Using athena connection "model.sampletikcetdata.new_sales"
[0m15:30:27.111989 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
SELECT '{"rowcount":43435,"data_scanned_in_bytes":2227733}';
[0m15:30:27.275959 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4f0130f5-be6f-49a8-bf96-7a8773c96b32
[0m15:30:28.864121 [debug] [Thread-1  ]: SQL status: OK 43435 in 1.751 seconds
[0m15:30:28.890281 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: Close
[0m15:30:28.892374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f8cee1-5fb8-4251-a6c3-135e70318b91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d32e0a0>]}
[0m15:30:28.893333 [info ] [Thread-1  ]: 1 of 1 OK created sql table model sample_ticket_database.new_sales ............. [[32mOK 43435[0m in 8.33s]
[0m15:30:28.894078 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:30:28.895245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:28.895607 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:30:28.897799 [info ] [MainThread]: 
[0m15:30:28.898197 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.52 seconds (10.52s).
[0m15:30:28.898923 [debug] [MainThread]: Command end result
[0m15:30:28.940509 [info ] [MainThread]: 
[0m15:30:28.941032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:30:28.941348 [info ] [MainThread]: 
[0m15:30:28.941662 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:30:28.943325 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.783074, "process_user_time": 3.58594, "process_kernel_time": 0.579223, "process_mem_max_rss": "167804928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:30:28.943804 [debug] [MainThread]: Command `dbt run` succeeded at 15:30:28.943728 after 12.78 seconds
[0m15:30:28.944131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d6d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c287550>]}
[0m15:30:28.944446 [debug] [MainThread]: Flushing usage events
[0m15:34:48.966847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f58a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f8130>]}


============================== 15:34:48.971148 | aafe7bdd-5723-4fa4-855c-1781dea36568 ==============================
[0m15:34:48.971148 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:34:48.971728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:34:49.576395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aafe7bdd-5723-4fa4-855c-1781dea36568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c9d60>]}
[0m15:34:49.625300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aafe7bdd-5723-4fa4-855c-1781dea36568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa22dc0>]}
[0m15:34:49.626550 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:34:49.741937 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:34:49.829038 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:34:49.829512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aafe7bdd-5723-4fa4-855c-1781dea36568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107424370>]}
[0m15:34:50.998966 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:34:51.015958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aafe7bdd-5723-4fa4-855c-1781dea36568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b85c130>]}
[0m15:34:51.130358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aafe7bdd-5723-4fa4-855c-1781dea36568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8d1760>]}
[0m15:34:51.131089 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:34:51.131594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aafe7bdd-5723-4fa4-855c-1781dea36568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b859ca0>]}
[0m15:34:51.132794 [info ] [MainThread]: 
[0m15:34:51.133794 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:34:51.134903 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:34:51.135314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:51.743974 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:34:51.745921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_sample_ticket_database)
[0m15:34:51.746388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:53.213890 [debug] [ThreadPool]: On list_AwsDataCatalog_sample_ticket_database: Close
[0m15:34:53.215595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aafe7bdd-5723-4fa4-855c-1781dea36568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8ce940>]}
[0m15:34:53.216152 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:34:53.216472 [info ] [MainThread]: 
[0m15:34:53.218386 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:34:53.218873 [info ] [Thread-1  ]: 1 of 1 START sql table model sample_ticket_database.new_sales .................. [RUN]
[0m15:34:53.219335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_sample_ticket_database, now model.sampletikcetdata.new_sales)
[0m15:34:53.219662 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:34:53.229215 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:34:53.230662 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:34:53.299483 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:34:53.300246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:34:53.844319 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:34:53.845956 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
create table "AwsDataCatalog"."sample_ticket_database"."new_sales"
    with (
      table_type='hive',
      is_external=true,external_location='s3://sample-snapshot-bucket/martdata/sample_ticket_database/new_sales/5adacf06-9a97-446b-8cf6-ca6a520a6a63',
      format='parquet'
    )
    as
      with sales as (

    select * from "AwsDataCatalog"."sample_ticket_database"."sales"

),

users as (

    select * from "AwsDataCatalog"."sample_ticket_database"."users"

),

rawdate as (

    select * from "AwsDataCatalog"."sample_ticket_database"."date"

),

new_sales as (
    select
        sellerid,
        username,
        -- (firstname ||''|| lastname) as name,
        city, 
        sum(qtysold) as qtysoldsum

    from sales, rawdate, users
    where sales.sellerid = users.userid
    and sales.dateid = rawdate.dateid
    group by sellerid, username, city
   
)


select * from new_sales
[0m15:34:54.242180 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3c7b13f3-8710-4f9a-938d-6c1ec16c7cc3
[0m15:34:58.181081 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":43435,"data_scanned_in_bytes":2227733}
[0m15:34:58.212945 [debug] [Thread-1  ]: Using athena connection "model.sampletikcetdata.new_sales"
[0m15:34:58.214294 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: alter table `sample_ticket_database`.`new_sales` set tblproperties ('classification' = 'parquet')
[0m15:34:58.378484 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ef472315-080c-42f6-8546-56032f6a3781
[0m15:34:59.955359 [debug] [Thread-1  ]: SQL status: OK -1 in 1.740 seconds
[0m15:34:59.960626 [debug] [Thread-1  ]: Writing runtime sql for node "model.sampletikcetdata.new_sales"
[0m15:34:59.964109 [debug] [Thread-1  ]: Using athena connection "model.sampletikcetdata.new_sales"
[0m15:34:59.965273 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
SELECT '{"rowcount":43435,"data_scanned_in_bytes":2227733}';
[0m15:35:00.133249 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9992d364-95ae-4a4c-8ff8-ae8a2f61ca18
[0m15:35:01.713181 [debug] [Thread-1  ]: SQL status: OK 43435 in 1.747 seconds
[0m15:35:01.746621 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: Close
[0m15:35:01.748905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aafe7bdd-5723-4fa4-855c-1781dea36568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbd0a0>]}
[0m15:35:01.749927 [info ] [Thread-1  ]: 1 of 1 OK created sql table model sample_ticket_database.new_sales ............. [[32mOK 43435[0m in 8.53s]
[0m15:35:01.750837 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:35:01.752819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:01.753298 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:35:01.756988 [info ] [MainThread]: 
[0m15:35:01.758298 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.62 seconds (10.62s).
[0m15:35:01.759595 [debug] [MainThread]: Command end result
[0m15:35:01.809052 [info ] [MainThread]: 
[0m15:35:01.810119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:01.810814 [info ] [MainThread]: 
[0m15:35:01.811367 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:35:01.816502 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.929603, "process_user_time": 3.617583, "process_kernel_time": 0.614348, "process_mem_max_rss": "164216832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:35:01.818009 [debug] [MainThread]: Command `dbt run` succeeded at 15:35:01.817872 after 12.93 seconds
[0m15:35:01.818605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f58a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa22dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ed550>]}
[0m15:35:01.819148 [debug] [MainThread]: Flushing usage events
[0m15:58:25.632737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e96d0>]}


============================== 15:58:25.638253 | 4b3527a9-93ca-4386-b389-4c3463b93126 ==============================
[0m15:58:25.638253 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:58:25.639034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:58:26.216904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b3527a9-93ca-4386-b389-4c3463b93126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b10e50>]}
[0m15:58:26.299622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b3527a9-93ca-4386-b389-4c3463b93126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126582b0>]}
[0m15:58:26.300855 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:58:26.415855 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:58:26.559281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:26.559833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:26.566589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:58:26.600367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b3527a9-93ca-4386-b389-4c3463b93126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ecd130>]}
[0m15:58:26.604860 [info ] [MainThread]: Performance info: /Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/target/perf_info.json
[0m15:58:26.690148 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.156226, "process_user_time": 2.118831, "process_kernel_time": 0.414854, "process_mem_max_rss": "129679360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:58:26.690752 [debug] [MainThread]: Command `cli parse` succeeded at 15:58:26.690652 after 1.16 seconds
[0m15:58:26.691110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f93a0>]}
[0m15:58:26.691437 [debug] [MainThread]: Flushing usage events
[0m15:58:27.325694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e9ac0>]}


============================== 15:58:27.326197 | 33ea3cc9-1b48-4479-99c6-53ca8e1e5030 ==============================
[0m15:58:27.326197 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:58:27.326637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:58:27.366957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33ea3cc9-1b48-4479-99c6-53ca8e1e5030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112cb370>]}
[0m15:58:27.368411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33ea3cc9-1b48-4479-99c6-53ca8e1e5030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e9a00>]}
[0m15:58:27.368897 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:58:27.395326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33ea3cc9-1b48-4479-99c6-53ca8e1e5030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f162e0>]}
[0m15:58:27.395832 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:58:27.396158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33ea3cc9-1b48-4479-99c6-53ca8e1e5030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f76730>]}
[0m15:58:27.398171 [info ] [MainThread]: 
[0m15:58:27.398837 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:58:27.400575 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:58:27.400981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:28.079847 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:58:28.082398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_sample_ticket_database)
[0m15:58:28.083185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:29.619091 [debug] [ThreadPool]: On list_AwsDataCatalog_sample_ticket_database: Close
[0m15:58:29.621082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33ea3cc9-1b48-4479-99c6-53ca8e1e5030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115112160>]}
[0m15:58:29.622618 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:58:29.622952 [info ] [MainThread]: 
[0m15:58:29.626933 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:58:29.627438 [info ] [Thread-1  ]: 1 of 1 START sql table model sample_ticket_database.new_sales .................. [RUN]
[0m15:58:29.627933 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_sample_ticket_database, now model.sampletikcetdata.new_sales)
[0m15:58:29.628522 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:58:29.646262 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:58:29.647296 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:58:29.685021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:58:30.951723 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 953891383645.sample_ticket_database.new_sales
[0m15:58:30.952477 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:58:30.955035 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:58:32.058917 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 953891383645.sample_ticket_database.new_sales
[0m15:58:32.060273 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:58:32.060989 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."sample_ticket_database"."new_sales" is stored in s3://sample-snapshot-bucket/martdata/sample_ticket_database/new_sales/5adacf06-9a97-446b-8cf6-ca6a520a6a63
[0m15:58:32.562800 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://sample-snapshot-bucket/martdata/sample_ticket_database/new_sales/5adacf06-9a97-446b-8cf6-ca6a520a6a63', bucket='sample-snapshot-bucket', prefix='martdata/sample_ticket_database/new_sales/5adacf06-9a97-446b-8cf6-ca6a520a6a63/'
[0m15:58:34.381062 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."sample_ticket_database"."new_sales"
[0m15:58:34.427282 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:58:34.774564 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:58:34.775587 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
create table "AwsDataCatalog"."sample_ticket_database"."new_sales"
    with (
      table_type='hive',
      is_external=true,external_location='s3://sample-snapshot-bucket/martdata/sample_ticket_database/new_sales/72414706-b7e8-42bd-9201-a3b0dd908914',
      format='parquet'
    )
    as
      with sales as (

    select * from "AwsDataCatalog"."sample_ticket_database"."sales"

),

users as (

    select * from "AwsDataCatalog"."sample_ticket_database"."users"

),

rawdate as (

    select * from "AwsDataCatalog"."sample_ticket_database"."date"

),

new_sales as (
    select
        sellerid,
        username,
        -- (firstname ||''|| lastname) as name,
        city, 
        sum(qtysold) as qtysoldsum

    from sales, rawdate, users
    where sales.sellerid = users.userid
    and sales.dateid = rawdate.dateid
    group by sellerid, username, city
   
)


select * from new_sales
[0m15:58:35.212794 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e02b8d26-1f6c-47b8-80e2-61cde36b2d26
[0m15:58:40.215934 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":43435,"data_scanned_in_bytes":2227733}
[0m15:58:40.228827 [debug] [Thread-1  ]: Using athena connection "model.sampletikcetdata.new_sales"
[0m15:58:40.229472 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: alter table `sample_ticket_database`.`new_sales` set tblproperties ('classification' = 'parquet')
[0m15:58:40.397304 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID faa1bd16-d036-43a2-b33d-395694849453
[0m15:58:41.960552 [debug] [Thread-1  ]: SQL status: OK -1 in 1.730 seconds
[0m15:58:41.965775 [debug] [Thread-1  ]: Writing runtime sql for node "model.sampletikcetdata.new_sales"
[0m15:58:41.968144 [debug] [Thread-1  ]: Using athena connection "model.sampletikcetdata.new_sales"
[0m15:58:41.968798 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
SELECT '{"rowcount":43435,"data_scanned_in_bytes":2227733}';
[0m15:58:42.139928 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b9ab7011-9cfc-4447-b999-61192e571389
[0m15:58:43.713391 [debug] [Thread-1  ]: SQL status: OK 43435 in 1.744 seconds
[0m15:58:43.725973 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: Close
[0m15:58:43.727517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33ea3cc9-1b48-4479-99c6-53ca8e1e5030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e9f0d0>]}
[0m15:58:43.728130 [info ] [Thread-1  ]: 1 of 1 OK created sql table model sample_ticket_database.new_sales ............. [[32mOK 43435[0m in 14.10s]
[0m15:58:43.728681 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:58:43.729637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:43.729899 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:58:43.731805 [info ] [MainThread]: 
[0m15:58:43.732234 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.33 seconds (16.33s).
[0m15:58:43.732850 [debug] [MainThread]: Command end result
[0m15:58:43.766878 [info ] [MainThread]: 
[0m15:58:43.767390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:43.767684 [info ] [MainThread]: 
[0m15:58:43.767988 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:58:43.768400 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.445366, "process_user_time": 3.095498, "process_kernel_time": 0.799862, "process_mem_max_rss": "166215680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:58:43.768865 [debug] [MainThread]: Command `cli run` succeeded at 15:58:43.768790 after 16.45 seconds
[0m15:58:43.769193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112582c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112582a90>]}
[0m15:58:43.769512 [debug] [MainThread]: Flushing usage events
[0m16:20:22.213062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736eeb0>]}


============================== 16:20:22.225774 | a9476dbf-130b-4714-ae48-65fcd0776e51 ==============================
[0m16:20:22.225774 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:20:22.227667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:20:24.030986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9476dbf-130b-4714-ae48-65fcd0776e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f6eb0>]}
[0m16:20:24.169363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9476dbf-130b-4714-ae48-65fcd0776e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105620400>]}
[0m16:20:24.171971 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m16:20:24.463105 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:20:24.689917 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:20:24.690847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9476dbf-130b-4714-ae48-65fcd0776e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d67670>]}
[0m16:20:28.377147 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m16:20:28.408503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9476dbf-130b-4714-ae48-65fcd0776e51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213f1130>]}
[0m16:20:28.433796 [info ] [MainThread]: Performance info: /Users/koukish/develop/startup-data-pipeline-samples/aurora-athena-sample/dbt/target/perf_info.json
[0m16:20:28.694691 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 6.9974456, "process_user_time": 7.005184, "process_kernel_time": 1.117374, "process_mem_max_rss": "122978304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:20:28.696494 [debug] [MainThread]: Command `cli parse` succeeded at 16:20:28.696222 after 7.00 seconds
[0m16:20:28.697263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12141ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12141a7c0>]}
[0m16:20:28.698022 [debug] [MainThread]: Flushing usage events
[0m15:51:04.571293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104956b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee7100>]}


============================== 15:51:04.579161 | c6bd4173-bf0b-4558-beb7-d4152f01c33b ==============================
[0m15:51:04.579161 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:51:04.580006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/koukish/develop/startup-data-pipeline-samples-dep/aurora-athena-sample/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/koukish/develop/startup-data-pipeline-samples-dep/aurora-athena-sample/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:51:05.198979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6bd4173-bf0b-4558-beb7-d4152f01c33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121046280>]}
[0m15:51:05.247325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6bd4173-bf0b-4558-beb7-d4152f01c33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e69df0>]}
[0m15:51:05.248440 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:51:05.364411 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:51:05.454673 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:51:05.455242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c6bd4173-bf0b-4558-beb7-d4152f01c33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059fdf40>]}
[0m15:51:06.610173 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sampletikcetdata.staging
[0m15:51:06.621967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6bd4173-bf0b-4558-beb7-d4152f01c33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121557e20>]}
[0m15:51:06.718776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6bd4173-bf0b-4558-beb7-d4152f01c33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215c8e80>]}
[0m15:51:06.719369 [info ] [MainThread]: Found 1 model, 3 sources, 455 macros
[0m15:51:06.719689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6bd4173-bf0b-4558-beb7-d4152f01c33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12155adf0>]}
[0m15:51:06.720763 [info ] [MainThread]: 
[0m15:51:06.721243 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:51:06.721931 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:51:06.722338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:07.448304 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:51:07.449764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_sample_ticket_database)
[0m15:51:07.450267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:09.149052 [debug] [ThreadPool]: On list_AwsDataCatalog_sample_ticket_database: Close
[0m15:51:09.151954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6bd4173-bf0b-4558-beb7-d4152f01c33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215c8460>]}
[0m15:51:09.152852 [info ] [MainThread]: Concurrency: 1 threads (target='athena')
[0m15:51:09.153391 [info ] [MainThread]: 
[0m15:51:09.156169 [debug] [Thread-1  ]: Began running node model.sampletikcetdata.new_sales
[0m15:51:09.156874 [info ] [Thread-1  ]: 1 of 1 START sql table model sample_ticket_database.new_sales .................. [RUN]
[0m15:51:09.157561 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_sample_ticket_database, now model.sampletikcetdata.new_sales)
[0m15:51:09.158054 [debug] [Thread-1  ]: Began compiling node model.sampletikcetdata.new_sales
[0m15:51:09.172167 [debug] [Thread-1  ]: Writing injected SQL for node "model.sampletikcetdata.new_sales"
[0m15:51:09.175236 [debug] [Thread-1  ]: Began executing node model.sampletikcetdata.new_sales
[0m15:51:09.238504 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:51:09.239174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:51:09.943971 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:51:09.945823 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
create table "AwsDataCatalog"."sample_ticket_database"."new_sales"
    with (
      table_type='hive',
      is_external=true,external_location='s3://sample-snapshot-bucket/martdata/sample_ticket_database/new_sales/1b03c05c-0c64-4007-986c-6d896fec1b0f',
      format='parquet'
    )
    as
      with sales as (

    select * from "AwsDataCatalog"."sample_ticket_database"."sales"

),

users as (

    select * from "AwsDataCatalog"."sample_ticket_database"."users"

),

rawdate as (

    select * from "AwsDataCatalog"."sample_ticket_database"."date"

),

new_sales as (
    select
        sellerid,
        username,
        -- (firstname ||''|| lastname) as name,
        city, 
        sum(qtysold) as qtysoldsum

    from sales, rawdate, users
    where sales.sellerid = users.userid
    and sales.dateid = rawdate.dateid
    group by sellerid, username, city
   
)


select * from new_sales
[0m15:51:10.468000 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 58a84d56-8c9a-4888-9105-aa9fbf9b2b74
[0m15:51:15.577221 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":43435,"data_scanned_in_bytes":1113788}
[0m15:51:15.585253 [debug] [Thread-1  ]: Using athena connection "model.sampletikcetdata.new_sales"
[0m15:51:15.585690 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: alter table `sample_ticket_database`.`new_sales` set tblproperties ('classification' = 'parquet')
[0m15:51:15.777243 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5332a907-265c-4b27-922e-d40b501c58b5
[0m15:51:17.479875 [debug] [Thread-1  ]: SQL status: OK -1 in 1.893 seconds
[0m15:51:17.485676 [debug] [Thread-1  ]: Writing runtime sql for node "model.sampletikcetdata.new_sales"
[0m15:51:17.488082 [debug] [Thread-1  ]: Using athena connection "model.sampletikcetdata.new_sales"
[0m15:51:17.488786 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "sampletikcetdata", "target_name": "athena", "node_id": "model.sampletikcetdata.new_sales"} */
SELECT '{"rowcount":43435,"data_scanned_in_bytes":1113788}';
[0m15:51:17.687625 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5a1d18a5-abec-4098-bd2e-a95f579cfb7d
[0m15:51:19.375766 [debug] [Thread-1  ]: SQL status: OK 43435 in 1.886 seconds
[0m15:51:19.403882 [debug] [Thread-1  ]: On model.sampletikcetdata.new_sales: Close
[0m15:51:19.405944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6bd4173-bf0b-4558-beb7-d4152f01c33b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1214b1370>]}
[0m15:51:19.406842 [info ] [Thread-1  ]: 1 of 1 OK created sql table model sample_ticket_database.new_sales ............. [[32mOK 43435[0m in 10.25s]
[0m15:51:19.407688 [debug] [Thread-1  ]: Finished running node model.sampletikcetdata.new_sales
[0m15:51:19.409037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:19.409452 [debug] [MainThread]: Connection 'model.sampletikcetdata.new_sales' was properly closed.
[0m15:51:19.411508 [info ] [MainThread]: 
[0m15:51:19.411918 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.69 seconds (12.69s).
[0m15:51:19.412812 [debug] [MainThread]: Command end result
[0m15:51:19.445312 [info ] [MainThread]: 
[0m15:51:19.445796 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:19.446133 [info ] [MainThread]: 
[0m15:51:19.446478 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:51:19.456660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.19815, "process_user_time": 3.614977, "process_kernel_time": 0.602324, "process_mem_max_rss": "166199296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:51:19.457183 [debug] [MainThread]: Command `dbt run` succeeded at 15:51:19.457105 after 15.20 seconds
[0m15:51:19.457513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104956b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121046280>]}
[0m15:51:19.457841 [debug] [MainThread]: Flushing usage events
